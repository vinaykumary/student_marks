<center><h3>Panimalar Institute of Technology</h3></center>
<center><h3>Department of <%=@department.name %></h3></center>
<center><h3><%= @year_map[@year]%> Year - Semester <%=@semester%></h3></center>
<center><h3><%= @exam.name %></h3></center>
<br>
<b>Max. Marks: 100</b>
<br>
<b>Exam Date: <%=@exam.date.to_date%></b>
<br>
<b>Section: <%=@section%></b>
<br>
<br>
<% if @single_sub_f==0 && @two_sub_f==0 && @gt_three_f==0 %>
  NIL FAILURES!
<% else %>
  <%if @single_sub_f!=0 %>
    <h4>No. of Failures in one Subject: <%=@single_sub_f%></h4>
    <table border=1>
        <tr>
          <th>SNO</th>
          <th>Roll No.</th>
          <th>Name</th>
          <% for subject in @subjects %>
            <th><%=subject.abbreviation%></th>
          <% end %>
        </tr>
        <% sno1=1 %>
        <% for student in @single_sub_studs %>
          <tr>
            <td><%=sno1%></td>
            <% sno1+=1 %>
            <td><%= student.roll_no %></td>
            <td><%=student.name %></td>
            <td><%if @sing_sub_marks[student.id][0].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][0].marks<50%>
              <b><%=@sing_sub_marks[student.id][0].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][0].marks%>
            <%end%></td>
        <td><%if @sing_sub_marks[student.id][1].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][1].marks<50%>
              <b><%=@sing_sub_marks[student.id][1].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][1].marks%>
            <%end%></td>
        <td><%if @sing_sub_marks[student.id][2].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][2].marks<50%>
              <b><%=@sing_sub_marks[student.id][2].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][2].marks%>
            <%end%></td>
        <td><%if @sing_sub_marks[student.id][3].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][3].marks<50%>
              <b><%=@sing_sub_marks[student.id][3].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][3].marks%>
            <%end%></td>
        <td><%if @sing_sub_marks[student.id][4].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][4].marks<50%>
              <b><%=@sing_sub_marks[student.id][4].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][4].marks%>
            <%end%></td>
        <td><%if @sing_sub_marks[student.id][5].marks==-1%>
              <%="AB"%>
            <%elsif @sing_sub_marks[student.id][5].marks<50%>
              <b><%=@sing_sub_marks[student.id][5].marks%></b>
            <%else%>
              <%=@sing_sub_marks[student.id][5].marks%>
            <%end%></td>
          </tr>
        <% end %>
    </table>
  <% end %>
  <%if @two_sub_f!=0 %>
    <br>
    <br>
    <br>
    <h4>No. of Failures in two Subjects: <%=@two_sub_f%></h4>
    <table border=1>
        <tr>
          <th>SNO</th>
          <th>Roll No.</th>
          <th>Name</th>

          <% for subject in @subjects %>
            <th><%=subject.abbreviation%></th>
          <% end %>
        </tr>
        <% sno2=1 %>
        <% for student in @two_sub_studs %>
          <tr>
            <td><%=sno2%></td>
            <% sno2+=1 %>
            <td><%=student.roll_no%></td>
            <td><%=student.name %></td>

            <td><%if @two_sub_marks[student.id][0].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][0].marks<50%>
              <b><%=@two_sub_marks[student.id][0].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][0].marks%>
            <%end%></td>
        <td><%if @two_sub_marks[student.id][1].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][1].marks<50%>
              <b><%=@two_sub_marks[student.id][1].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][1].marks%>
            <%end%></td>
        <td><%if @two_sub_marks[student.id][2].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][2].marks<50%>
              <b><%=@two_sub_marks[student.id][2].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][2].marks%>
            <%end%></td>
        <td><%if @two_sub_marks[student.id][3].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][3].marks<50%>
              <b><%=@two_sub_marks[student.id][3].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][3].marks%>
            <%end%></td>
        <td><%if @two_sub_marks[student.id][4].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][4].marks<50%>
              <b><%=@two_sub_marks[student.id][4].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][4].marks%>
            <%end%></td>
        <td><%if @two_sub_marks[student.id][5].marks==-1%>
              <%="AB"%>
            <%elsif @two_sub_marks[student.id][5].marks<50%>
              <b><%=@two_sub_marks[student.id][5].marks%></b>
            <%else%>
              <%=@two_sub_marks[student.id][5].marks%>
            <%end%></td>
          </tr>
        <% end %>
    </table>
  <% end %>
  <%if @gt_three_f!=0 %>
    <br>
    <br>
    <br>
    <h4>No. of Failures in 3 or more Subjects: <%=@gt_three_f%></h4>
    <table border=1>
        <tr>
          <th>SNO</th>
          <th>Roll No.</th>
          <th>Name</th>

          <% for subject in @subjects %>
            <th><%=subject.abbreviation%></th>
          <% end %>
        </tr>
        <% sno2=1 %>
        <% for student in @gt_three_sub_studs %>
          <tr>
            <td><%=sno2%></td>
            <% sno2+=1 %>
            <td><%=student.roll_no%></td>
            <td><%=student.name %></td>

            <td><%if @gt_three_sub_marks[student.id][0].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][0].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][0].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][0].marks%>
            <%end%></td>
        <td><%if @gt_three_sub_marks[student.id][1].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][1].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][1].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][1].marks%>
            <%end%></td>
        <td><%if @gt_three_sub_marks[student.id][2].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][2].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][2].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][2].marks%>
            <%end%></td>
        <td><%if @gt_three_sub_marks[student.id][3].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][3].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][3].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][3].marks%>
            <%end%></td>
        <td><%if @gt_three_sub_marks[student.id][4].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][4].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][4].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][4].marks%>
            <%end%></td>
        <td><%if @gt_three_sub_marks[student.id][5].marks==-1%>
              <%="AB"%>
            <%elsif @gt_three_sub_marks[student.id][5].marks<50%>
              <b><%=@gt_three_sub_marks[student.id][5].marks%></b>
            <%else%>
              <%=@gt_three_sub_marks[student.id][5].marks%>
            <%end%></td>
          </tr>
        <% end %>
    </table>
  <% end %>
<% end %>
